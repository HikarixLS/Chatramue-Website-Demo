var F=Object.defineProperty,j=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var L=(i,n,l)=>n in i?F(i,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[n]=l,$=(i,n)=>{for(var l in n||(n={}))E.call(n,l)&&L(i,l,n[l]);if(x)for(var l of x(n))G.call(n,l)&&L(i,l,n[l]);return i},w=(i,n)=>j(i,Q(n));import{o as H,r as _,K,c as y,e as c,h as R,f as r,g as e,t as u,F as C,p as M,l as h,L as X,M as T,k as D,v as A,I as J}from"./vendor-cBPYqRmV.js";import{u as W}from"./index-bjyb_TEr.js";const Y={class:"modal-header"},Z={class:"modal-body"},ee={class:"product-info"},te=["src","alt"],se={class:"product-details"},le={class:"base-price"},ie={class:"toppings-section"},oe={class:"toppings-list"},ne=["value"],ae={class:"topping-name"},ue={class:"topping-price"},de={class:"options-section"},ce={class:"option-group"},re={class:"option-list"},pe=["value"],ve={class:"option-group"},me={class:"option-list"},ge=["value"],be={class:"option-group"},_e={class:"option-list"},ye=["value"],he={class:"quantity-section"},fe={class:"quantity-controls"},ke=["disabled"],Ce=["disabled"],Me={class:"total-price"},Ve={class:"modal-footer"},qe={__name:"ToppingModal",props:{isVisible:{type:Boolean,default:!1},product:{type:Object,required:!0}},emits:["close","add-to-cart"],setup(i,{emit:n}){const l=W(),p=i;H(()=>{l.initializeData()});const q=n,v=_([]),m=_("ice-100"),g=_("sugar-100"),b=_("size-m"),a=_(1);K(()=>p.isVisible,o=>{o&&(v.value=[],m.value="ice-100",g.value="sugar-100",b.value="size-m",a.value=1)});const I=y(()=>p.product.availableToppings?l.toppings.filter(o=>p.product.availableToppings.includes(o.id)):[]),O=y(()=>l.toppings.filter(o=>v.value.includes(o.id))),V=y(()=>O.value.reduce((o,t)=>o+t.price,0)),P=y(()=>l.sizeOptions.find(o=>o.id===b.value)),S=y(()=>(p.product.price*P.value.priceMultiplier+V.value)*a.value),f=o=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o),N=()=>{a.value<10&&a.value++},U=()=>{a.value>1&&a.value--},k=()=>{q("close")},B=()=>{const o=l.iceOptions.find(z=>z.id===m.value),t=l.sugarOptions.find(z=>z.id===g.value),s=P.value,d=w($({},p.product),{selectedToppings:O.value,iceLevel:o,sugarLevel:t,size:s,toppingsPrice:V.value,totalPrice:p.product.price*s.priceMultiplier+V.value,quantity:a.value,cartId:`${p.product.id}_${v.value.sort().join("_")}_${m.value}_${g.value}_${b.value}_${Date.now()}`});q("add-to-cart",d),k()};return(o,t)=>i.isVisible?(r(),c("div",{key:0,class:"topping-modal-overlay",onClick:k},[e("div",{class:"topping-modal",onClick:t[5]||(t[5]=J(()=>{},["stop"]))},[e("div",Y,[e("h3",null,"Chọn topping cho "+u(i.product.name),1),e("button",{class:"close-btn",onClick:k},"×")]),e("div",Z,[e("div",ee,[e("img",{src:i.product.image,alt:i.product.name,class:"product-image"},null,8,te),e("div",se,[e("h4",null,u(i.product.name),1),e("p",le,"Giá gốc: "+u(f(i.product.price)),1)])]),e("div",ie,[t[6]||(t[6]=e("h4",null,"Chọn topping (tùy chọn):",-1)),e("div",oe,[(r(!0),c(C,null,M(I.value,s=>(r(),c("label",{key:s.id,class:"topping-item"},[h(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[0]||(t[0]=d=>v.value=d)},null,8,ne),[[X,v.value]]),e("span",ae,u(s.name),1),e("span",ue,"+"+u(f(s.price)),1)]))),128))])]),e("div",de,[e("div",ce,[t[7]||(t[7]=e("h4",null,"Chọn kích thước:",-1)),e("div",re,[(r(!0),c(C,null,M(D(l).sizeOptions,s=>(r(),c("label",{key:s.id,class:"option-item size-option"},[h(e("input",{type:"radio",value:s.id,"onUpdate:modelValue":t[1]||(t[1]=d=>b.value=d),name:"size-level"},null,8,pe),[[T,b.value]]),e("span",null,u(s.name),1)]))),128))])]),e("div",ve,[t[8]||(t[8]=e("h4",null,"Mức độ đá:",-1)),e("div",me,[(r(!0),c(C,null,M(D(l).iceOptions,s=>(r(),c("label",{key:s.id,class:"option-item"},[h(e("input",{type:"radio",value:s.id,"onUpdate:modelValue":t[2]||(t[2]=d=>m.value=d),name:"ice-level"},null,8,ge),[[T,m.value]]),e("span",null,u(s.name),1)]))),128))])]),e("div",be,[t[9]||(t[9]=e("h4",null,"Mức độ đường:",-1)),e("div",_e,[(r(!0),c(C,null,M(D(l).sugarOptions,s=>(r(),c("label",{key:s.id,class:"option-item"},[h(e("input",{type:"radio",value:s.id,"onUpdate:modelValue":t[3]||(t[3]=d=>g.value=d),name:"sugar-level"},null,8,ye),[[T,g.value]]),e("span",null,u(s.name),1)]))),128))])])]),e("div",he,[t[10]||(t[10]=e("label",{for:"quantity"},"Số lượng:",-1)),e("div",fe,[e("button",{onClick:U,disabled:a.value<=1},"-",8,ke),h(e("input",{type:"number",id:"quantity","onUpdate:modelValue":t[4]||(t[4]=s=>a.value=s),min:"1",max:"10"},null,512),[[A,a.value,void 0,{number:!0}]]),e("button",{onClick:N,disabled:a.value>=10},"+",8,Ce)])]),e("div",Me,[e("strong",null,"Tổng cộng: "+u(f(S.value)),1)])]),e("div",Ve,[e("button",{class:"cancel-btn",onClick:k},"Hủy"),e("button",{class:"add-to-cart-btn",onClick:B}," Xác nhận - "+u(f(S.value)),1)])])])):R("",!0)}};export{qe as _};
