var x=(P,y,p)=>new Promise((f,d)=>{var w=e=>{try{i(p.next(e))}catch(b){d(b)}},c=e=>{try{i(p.throw(e))}catch(b){d(b)}},i=e=>e.done?f(e.value):Promise.resolve(e.value).then(w,c);i((p=p.apply(P,y)).next())});import{r as B,N as T,c as I,o as O,e as a,g as s,t as o,k as m,n as k,j as _,h as g,I as C,l as h,v,i as $,w as E,b as H,F as V,p as L,u as K,f as r}from"./vendor-cBPYqRmV.js";import{c as A,b as Q,g as R}from"./index-obp5zDkU.js";const X={class:"profile-section"},G={class:"profile-container"},J={class:"profile-content"},W={class:"profile-sidebar"},Y={class:"profile-avatar"},Z={class:"profile-nav"},ss={class:"profile-main"},ts={key:0,class:"tab-content"},ns={class:"form-row"},es={class:"form-group"},os=["disabled"],is={class:"form-group"},ls=["disabled"],as={class:"form-group"},rs=["disabled"],ds={class:"form-group"},us=["disabled"],ps={class:"form-actions"},cs=["disabled"],ms={key:0,class:"fas fa-spinner fa-spin"},fs={key:1,class:"tab-content"},gs={class:"orders-list"},hs={key:0,class:"empty-state"},vs={key:1,class:"orders-container"},ws={class:"order-header"},bs={class:"order-info"},_s={class:"order-date"},ks={class:"order-status"},ys={class:"order-total"},Ps={class:"order-items"},Ns=["src","alt"],xs={class:"item-details"},Ts={class:"item-options"},Cs={key:0},Vs={key:1},Ls={key:2},Ms={key:3},Ss={class:"item-quantity-price"},Us={class:"item-price"},qs={class:"order-delivery"},Ds={key:2,class:"tab-content"},zs={class:"settings-section"},Fs={class:"form-group"},js={class:"form-group"},Bs={class:"form-group"},Es={__name:"Profile",setup(P){const y=K(),p=A(),{showNotification:f}=Q(),d=B("info"),{user:w,isLoading:c}=p,i=T({fullName:"",email:"",phone:"",address:""}),e=T({currentPassword:"",newPassword:"",confirmNewPassword:""}),b=I(()=>p.orders||[]),M=u=>new Date(u).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=u=>new Intl.NumberFormat("vi-VN").format(u),S=u=>({pending:"Đang xử lý",confirmed:"Đã xác nhận",preparing:"Đang chuẩn bị",shipping:"Đang giao hàng",delivered:"Đã giao hàng",cancelled:"Đã hủy"})[u]||"Không xác định";O(()=>{w.value&&Object.assign(i,w.value),p.loadOrders()});const U=()=>x(null,null,function*(){const u=yield p.updateProfile({fullName:i.fullName,phone:i.phone,address:i.address});u.success?f("Cập nhật thông tin thành công!","success"):f(u.error,"error")}),q=()=>{if(e.newPassword!==e.confirmNewPassword){f("Mật khẩu xác nhận không khớp","error");return}if(e.newPassword.length<6){f("Mật khẩu mới phải có ít nhất 6 ký tự","error");return}f("Đổi mật khẩu thành công!","success"),Object.assign(e,{currentPassword:"",newPassword:"",confirmNewPassword:""})},D=()=>{p.logout(),f("Đăng xuất thành công!","success"),y.push("/")},z=u=>R(u);return(u,t)=>{const F=H("router-link");return r(),a("div",X,[s("div",G,[t[32]||(t[32]=s("div",{class:"profile-header"},[s("h1",null,"Thông Tin Tài Khoản"),s("p",null,"Quản lý thông tin cá nhân và cài đặt tài khoản")],-1)),s("div",J,[s("div",W,[s("div",Y,[t[10]||(t[10]=s("div",{class:"avatar-circle"},[s("i",{class:"fas fa-user"})],-1)),s("h3",null,o(m(w).fullName),1),s("p",null,o(m(w).email),1)]),s("nav",Z,[s("button",{onClick:t[0]||(t[0]=n=>d.value="info"),class:k([{active:d.value==="info"},"nav-item"])},t[11]||(t[11]=[s("i",{class:"fas fa-user"},null,-1),_(" Thông tin cá nhân ",-1)]),2),s("button",{onClick:t[1]||(t[1]=n=>d.value="orders"),class:k([{active:d.value==="orders"},"nav-item"])},t[12]||(t[12]=[s("i",{class:"fas fa-shopping-bag"},null,-1),_(" Lịch sử đơn hàng ",-1)]),2),s("button",{onClick:t[2]||(t[2]=n=>d.value="settings"),class:k([{active:d.value==="settings"},"nav-item"])},t[13]||(t[13]=[s("i",{class:"fas fa-cog"},null,-1),_(" Cài đặt ",-1)]),2),s("button",{onClick:D,class:"nav-item logout"},t[14]||(t[14]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),_(" Đăng xuất ",-1)]))])]),s("div",ss,[d.value==="info"?(r(),a("div",ts,[t[19]||(t[19]=s("h2",null,"Thông tin cá nhân",-1)),s("form",{onSubmit:C(U,["prevent"]),class:"profile-form"},[s("div",ns,[s("div",es,[t[15]||(t[15]=s("label",{for:"fullName"},"Họ và tên",-1)),h(s("input",{type:"text",id:"fullName","onUpdate:modelValue":t[3]||(t[3]=n=>i.fullName=n),disabled:m(c),required:""},null,8,os),[[v,i.fullName]])]),s("div",is,[t[16]||(t[16]=s("label",{for:"phone"},"Số điện thoại",-1)),h(s("input",{type:"tel",id:"phone","onUpdate:modelValue":t[4]||(t[4]=n=>i.phone=n),disabled:m(c)},null,8,ls),[[v,i.phone]])])]),s("div",as,[t[17]||(t[17]=s("label",{for:"email"},"Email",-1)),h(s("input",{type:"email",id:"email","onUpdate:modelValue":t[5]||(t[5]=n=>i.email=n),disabled:m(c),required:""},null,8,rs),[[v,i.email]])]),s("div",ds,[t[18]||(t[18]=s("label",{for:"address"},"Địa chỉ",-1)),h(s("textarea",{id:"address","onUpdate:modelValue":t[6]||(t[6]=n=>i.address=n),disabled:m(c),rows:"3",placeholder:"Nhập địa chỉ của bạn"},null,8,us),[[v,i.address]])]),s("div",ps,[s("button",{type:"submit",class:"save-btn",disabled:m(c)},[m(c)?(r(),a("i",ms)):g("",!0),s("span",null,o(m(c)?"Đang lưu...":"Lưu thay đổi"),1)],8,cs)])],32)])):g("",!0),d.value==="orders"?(r(),a("div",fs,[t[25]||(t[25]=s("h2",null,"Lịch sử đơn hàng",-1)),s("div",gs,[b.value.length===0?(r(),a("div",hs,[t[21]||(t[21]=s("i",{class:"fas fa-shopping-bag"},null,-1)),t[22]||(t[22]=s("h3",null,"Chưa có đơn hàng nào",-1)),t[23]||(t[23]=s("p",null,"Bạn chưa thực hiện đơn hàng nào. Hãy khám phá các sản phẩm của chúng tôi!",-1)),$(F,{to:"/products",class:"shop-now-btn"},{default:E(()=>t[20]||(t[20]=[_(" Mua sắm ngay ",-1)])),_:1,__:[20]})])):(r(),a("div",vs,[(r(!0),a(V,null,L(b.value,n=>(r(),a("div",{key:n.id,class:"order-card"},[s("div",ws,[s("div",bs,[s("h3",null,"Đơn hàng #"+o(n.id),1),s("span",_s,o(M(n.orderDate)),1)]),s("div",ks,[s("span",{class:k(["status-badge",n.status])},o(S(n.status)),3),s("span",ys,o(N(n.total))+"đ",1)])]),s("div",Ps,[(r(!0),a(V,null,L(n.items,l=>(r(),a("div",{key:l.id,class:"order-item"},[s("img",{src:z(l.image),alt:l.name,class:"item-image"},null,8,Ns),s("div",xs,[s("h4",null,o(l.name),1),s("div",Ts,[l.size&&l.size.value?(r(),a("span",Cs,"Size: "+o(l.size.value),1)):g("",!0),l.iceLevel?(r(),a("span",Vs,"Đá: "+o(l.iceLevel.name),1)):g("",!0),l.sugarLevel?(r(),a("span",Ls,"Đường: "+o(l.sugarLevel.name),1)):g("",!0),l.selectedToppings&&l.selectedToppings.length>0?(r(),a("span",Ms," Topping: "+o(l.selectedToppings.map(j=>j.name).join(", ")),1)):g("",!0)]),s("div",Ss,[s("span",null,"x"+o(l.quantity),1),s("span",Us,o(N(l.totalPrice))+"đ",1)])])]))),128))]),s("div",qs,[t[24]||(t[24]=s("h4",null,"Thông tin giao hàng",-1)),s("p",null,[s("strong",null,o(n.customer.fullName),1),_(" - "+o(n.customer.phone),1)]),s("p",null,o(n.customer.address),1)])]))),128))]))])])):g("",!0),d.value==="settings"?(r(),a("div",Ds,[t[31]||(t[31]=s("h2",null,"Cài đặt tài khoản",-1)),s("div",zs,[t[30]||(t[30]=s("h3",null,"Đổi mật khẩu",-1)),s("form",{onSubmit:C(q,["prevent"]),class:"password-form"},[s("div",Fs,[t[26]||(t[26]=s("label",{for:"currentPassword"},"Mật khẩu hiện tại",-1)),h(s("input",{type:"password",id:"currentPassword","onUpdate:modelValue":t[7]||(t[7]=n=>e.currentPassword=n),required:""},null,512),[[v,e.currentPassword]])]),s("div",js,[t[27]||(t[27]=s("label",{for:"newPassword"},"Mật khẩu mới",-1)),h(s("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[8]||(t[8]=n=>e.newPassword=n),required:"",minlength:"6"},null,512),[[v,e.newPassword]])]),s("div",Bs,[t[28]||(t[28]=s("label",{for:"confirmNewPassword"},"Xác nhận mật khẩu mới",-1)),h(s("input",{type:"password",id:"confirmNewPassword","onUpdate:modelValue":t[9]||(t[9]=n=>e.confirmNewPassword=n),required:"",minlength:"6"},null,512),[[v,e.confirmNewPassword]])]),t[29]||(t[29]=s("button",{type:"submit",class:"change-password-btn"}," Đổi mật khẩu ",-1))],32)])])):g("",!0)])])])])}}};export{Es as default};
